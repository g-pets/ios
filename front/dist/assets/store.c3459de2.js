import{o as e,_ as t}from"./index.bc852a36.js";import{a}from"./vendor.06a1fbca.js";function r(r){const l=a([]),c=e("iOS",1,{upgrade(e){const t=e.createObjectStore(r,{keyPath:"id",autoIncrement:!1});t.createIndex("id","id"),t.createIndex("created","created")}}),o=()=>JSON.stringify(Date.now()),n=async(e={})=>{let a,n,d;try{a=o(),n=t(e),n.id=a,n.created=Date.now(),l.value.push(n);const s=await c;d=await s.add(r,n)}catch(s){console.error(s)}finally{a=null,n=null,d=null}};return{records:l,getRecordF:async e=>{let t;try{return t={content:"343"},t}catch(a){console.error(a)}finally{t=null}},getRecords:async()=>{let e;try{const t=await c;e=await t.getAllFromIndex(r,"created"),l.value=e}catch(t){console.error(t)}finally{e=null}},createRecord:n,updateRecord:async e=>{let a,r,c;try{let o=e._id;a=t(l[o]),r=t(e),r.updated=Date.now(),l[o]=r,c=await restRequest({method:"put",module:module,id:o,data:r}),c.ok||(l[o]=a)}catch(o){console.error(o)}finally{a=null,r=null,c=null}},dublicateRecord:async e=>{let a,r;try{a=l[e],r=t(a),await n(r)}catch(c){console.error(c)}finally{a=null,r=null}},deleteRecord:async e=>{let t;try{l[e].hidden=!0,t=await restRequest({method:"delete",module:module,id:e}),t.ok?delete l[e]:l[e].hidden=!1}catch(a){console.error(a)}finally{t=null}},createDummyRecords:async(e,t)=>{try{let a=await fetch(`http://localhost:85/v1/${e}/${t}`);(await a.json()).forEach((e=>n(e)))}catch(a){console.error(a)}},deleteAllRecords:async()=>{try{l.value=[];const e=await c;await e.clear(r)}catch(e){console.error(e)}},generateId:o}}export{r as u};
